<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>实验test</title>
    
    <script src="https://www.naodao.com/public/experiment/libs/jspsych-7/jspsych.js"></script>
    <script src="https://www.naodao.com/public/experiment/libs/plugin/plugin-video-button-response.js"></script>
    <script src="https://www.naodao.com/public/experiment/libs/plugin/plugin-html-button-response.js"></script>
    <script src="https://www.naodao.com/public/experiment/libs/plugin/plugin-html-keyboard-response.js"></script>
    <script src="https://www.naodao.com/public/experiment/libs/plugin/plugin-external-html.js"></script>
    <script src="https://www.naodao.com/public/experiment/libs/plugin/plugin-preload.js"></script>
    
    <script src="https://www.naodao.com/public/experiment/libs/extension/naodao-2021-12.js"></script>
    <script src="https://www.naodao.com/public/experiment/libs/axios.min.js"></script>

    <link rel="stylesheet" href="https://www.naodao.com/public/experiment/libs/jspsych-7/css/jspsych.css">
</head>
<body></body>
<script>

  var jsPsych = initJsPsych({
    on_finish: function() {
      jsPsych.data.displayData();
      extensions: [
        {type: Naodao}
      ]
    }
  });

  // preloading videos only works when the file is running on a server
  // if you run this experiment by opening the file directly in the browser, 
  // then video preloading will be disabled to prevent CORS errors
  var preload = {
    type: jsPsychPreload,
    auto_preload: true
  };

  var pre_trial = {
    type: jsPsychHtmlButtonResponse,
    stimulus: '<div style="max-width:600px;"><p>你好，欢迎参与实验！</p></div>',
    choices: ['点击继续']
  };

  var trial_1 = {
    type: jsPsychVideoButtonResponse,
    stimulus: ['video/flower.mp4'],
    choices: ['Y'],
    margin_vertical: '10px',
    margin_horizontal: '8px',
    prompt: '请观看以上视频，观看结束后请点击按钮“Y”',
    width: 600,
    //height: 600,
    autoplay: true,
    //controls: true,
    //start: 8,
    //stop: 9,
    rate: 1,
    //trial_duration: null,
    response_ends_trial: true
  };

  var trial_2 = {
      type: jsPsychHtmlKeyboardResponse,
      stimulus: '<p>接下来进入到下一环节</p>'+
      '<p>Press any key to continue.</p>'
    };

  var trial_3 = {
      type: jsPsychExternalHtml,
      url: 'zgamepage.html',
      cont_btn: 'start',
      check_fn: function() {
        if (document.getElementById('consent_checkbox').checked) {
          return true;
        } else {
          alert('您必须勾选复选框才能继续。')
        }
      }
    };

    var trial_4 = {
      type: jsPsychExternalHtml,
      url: 'question.html',
      cont_btn: 'start',
      check_fn: null
    };

  var trial_5 = {
      type: jsPsychHtmlButtonResponse,
      stimulus: '5秒后结束实验，您可以回到上一个窗口继续下一个环节。',
      choices: ['OK'],
      trial_duration: 5000,
      response_ends_trial: true,
      prompt: "<p> </p>",
      extensions: [
      {type: Naodao}
    ]
    };

  jsPsych.run([preload, pre_trial, trial_1, trial_2, trial_3, trial_4]);

</script>
</html>
